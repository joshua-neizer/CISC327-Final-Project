# R1 - /login [GET]

## R1.1
**If the user hasn't logged in, show the login page**

Mocking:
* session data session['logged_in']

Actions:
* get element session['logged_in']
* if None redirect user to /login

## R1.2
**The login page has a message that by default says 'please login'**

Actions:
* open /login with [GET]
* call login_get()
* validate render_template calls with message
* validate /login has message flashed

## R1.3
**If the user has logged in, redirect to the user profile page**

Mocking:
* get_user to make test user

Actions:
* open /logout to remove any current sessions
* open /login
* enter user email into #email
* enter user password into #password
* click submit
* if no errors redirect to / code 303
* validate page has #welcome-message

## R1.4
**The login page provides a login form which requests two fields: email and passowrds**

Actions:
* open /login
* validate form has #email field
* validate form has #password field
* if fields exist, do nothing
* if fields do not exist reopen /login

## R1.5
**[POST]**

Actions:
* redirect URL is /login with [POST] method

## R1.6
**The login form can be submitted as a POST request to the current URL /login**

Actions:
* if not redirect to / code 303
	* assert POST response to /login with required message

## R1.7
**Email and password both cannot be empty**

Mocking:
* get_user test user

Actions:
* open /login
* enter user email into #email
* enter user password into #password
* click submit
* if #email and/or #password empty
	* assert POST request to /login with error message 'login failed'

## R1.8
**Email has to follow addr-spec defined in RFC 5322**

Mocking:
* get_user test user

Actions:
* enter user email into #email
* request.form.get('email')
* validate email follows all RFC 5322 spec (e.g. local part of address can contain <code>A to Z, 0 to 9, !#$&'\*+-/=?^\_\`{|}\~</code>
* if proper format do nothing
* if issue with format assert POST /login response with email error

## R1.9
**Password has to meet the required complexity**

Mocking:
* get_user test user

Actions:
* enter password into #password
* request.form.get('password')
* validate email follows required complexity (i.e. min length 6, at least one upper case, at least one one lower case, at least one special character)
* if required complexity, do nothing
* if issue with complexity assert POST /login response with password error

## R1.10
**For any formatting errors, render the login page and show the message 'email/password format is incorrect'**

Mocking:
* get_user test user

Actions:
* enter email into #email
* enter password into #password
* valdiate #email meets RFC 5322 specs
* validate #password meets complexity specs
* if issue with validation, assert POST /login with error message 'email/password format is incorrect'

## R1.11
**If email/password are correct, redirect to /**

Mocking:
* get_user test user with session data

Actions:
* enter email into #email
* enter password into #password
* click submit
* backend calls login_user(email,password)
* if #email and #password match parameters, redirect to /

## R1.12
**Otherwise, redirect to /login and show message 'email/password combination incorrect'**

Mocking:
* get_user test user with session data

Actions:
* enter email into #email
* enter password into #password
* click submit
* backend calls login_user(email,password)
* #email and #password don't match parameters
* assert POST /login message 'email/password combination incorrect'